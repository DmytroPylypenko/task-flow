<div class="board-detail-container">
  @if (isLoading) {
  <p>Loading board...</p>
  } @else if (errorMessage) {
  <div class="error-message">
    <p>{{ errorMessage }}</p>
  </div>
  } @else if (board) {
  <h1>{{ board.name }}</h1>

  <div class="columns-container" cdkDropListGroup>
    @for (column of board.columns; track column.id) {
    <div class="column">
      <h3>{{ column.name }}</h3>

      <form [formGroup]="newTaskForms.get(column.id)!" (ngSubmit)="onCreateTask(column)">
        <input type="text" formControlName="title" placeholder="New task...">
        <button type="submit" [disabled]="newTaskForms.get(column.id)?.invalid">[+]</button>
      </form>

      <ul
        cdkDropList
        [id]="column.id.toString()"
        [cdkDropListData]="column.tasks"
        (cdkDropListDropped)="drop($event)"
      >

        @for (task of column.tasks; track task.id) {
        <li class="task-card" cdkDrag>{{ task.title }}</li>
        } @empty {
        <p class="no-tasks">No tasks in this column.</p>
        }
      </ul>
    </div>
    }
  </div>
  }
</div>
